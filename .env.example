## Docker Image Configuration
## ===========================

## Docker Image Selection
## -----------------------
## SimpleLogin supports multiple ways to specify the Docker image:
##
## Option 1: Use the default image (recommended for this fork)
##   - Leave SL_CUSTOM_IMAGE commented out
##   - The image is constructed as: ${SL_DOCKER_REPO}/${SL_IMAGE}:${SL_VERSION}
##   - Default: clem16/simplelogin-app:v2026.02.02-staging-test-02
##
## Option 2: Override with a custom image
##   - Set SL_CUSTOM_IMAGE to your full image path (e.g., myregistry/myimage:mytag)
##   - This overrides SL_DOCKER_REPO, SL_IMAGE, and SL_VERSION
##   - Example: SL_CUSTOM_IMAGE=ghcr.io/myuser/simplelogin-app:custom-v1
##
## Option 3: Use upstream/official SimpleLogin image
##   - Set SL_DOCKER_REPO=simplelogin, SL_IMAGE=app-ci, SL_VERSION=v4.70.0
##   - Note: Official images may not be compatible with this fork's features
##
## Docker repository (default: clem16)
## Change this to use images from a different registry or organization
SL_DOCKER_REPO=clem16

## Image name (default: simplelogin-app)
## The name of the Docker image within the repository
SL_IMAGE=simplelogin-app

## Image version/tag (default: v2026.02.02-staging-test-02)
## IMPORTANT: This fork uses a custom Docker image from clem16/simplelogin-app
## DO NOT change this to official SimpleLogin versions (e.g., v4.70.0)
## as they use a different image (simplelogin/app-ci) and will not work.
SL_VERSION=v2026.02.02-staging-test-02

## Custom Docker Image Override (optional)
## Uncomment and set this to use a completely custom Docker image.
## When set, this overrides SL_DOCKER_REPO, SL_IMAGE, and SL_VERSION.
## Format: registry/organization/image:tag
## Examples:
##   - For testing: SL_CUSTOM_IMAGE=myregistry/simplelogin-test:latest
##   - For custom build: SL_CUSTOM_IMAGE=ghcr.io/myuser/simplelogin-app:custom
##   - For local image: SL_CUSTOM_IMAGE=local/simplelogin-app:dev
# SL_CUSTOM_IMAGE=

## Configuration File Path (optional)
## Path to the environment configuration file (default: .env)
## Set this to use a different configuration file location.
## This is useful for:
##   - Testing with different configurations
##   - Managing multiple environments (dev, staging, prod)
##   - Using a non-standard config location
## Examples:
##   - SL_CONFIG_PATH=.env.production
##   - SL_CONFIG_PATH=/opt/simplelogin/config/.env
##   - SL_CONFIG_PATH=configs/testing.env
# SL_CONFIG_PATH=.env

## Resource Optimization
## ====================
## SimpleLogin automatically detects available RAM/CPU and tunes configuration.
## These settings allow manual overrides and memory limits for containers.

## Force low-memory mode (automatically uses minimal resources)
## Set to 'true' on systems with < 768MB RAM
# LOW_MEMORY_MODE=false

## Manual overrides for dynamic resource configuration
## Leave commented to use automatic detection
# SL_GUNICORN_WORKERS_OVERRIDE=2          # Number of web app workers
# SL_GUNICORN_TIMEOUT_OVERRIDE=30         # Request timeout in seconds
# SL_MAX_REQUESTS_OVERRIDE=1000           # Max requests per worker before restart
# SL_DB_POOL_SIZE_OVERRIDE=10             # Database connection pool size

## Docker memory limits (applied per container)
## Adjust based on your system's total RAM
# SL_APP_MEMORY_LIMIT=1G                  # Web app container limit
# SL_APP_MEMORY_RESERVATION=256M          # Web app minimum reservation
# SL_EMAIL_MEMORY_LIMIT=512M              # Email handler container limit
# SL_EMAIL_MEMORY_RESERVATION=128M        # Email handler minimum reservation
# SL_JOB_MEMORY_LIMIT=512M                # Job runner container limit
# SL_JOB_MEMORY_RESERVATION=128M          # Job runner minimum reservation
# SL_DB_MEMORY_LIMIT=512M                 # Database container limit
# SL_DB_MEMORY_RESERVATION=256M           # Database minimum reservation

## Postgres Database
## =================

POSTGRES_DB=simplelogin

POSTGRES_USER=paste-user-here
POSTGRES_PASSWORD=paste-password-here

## Postfix
## =======

## Obtain this key here: https://www.spamhaus.com/free-trial/sign-up-for-a-free-data-query-service-account/
## Why? https://check.spamhaus.org/returnc/pub
#SPAMHAUS_DQS_KEY=

## SimpleLogin App
## ===============

## domain used to create alias
DOMAIN=paste-domain-here
SUBDOMAIN=app

EMAIL_DOMAIN=$DOMAIN

## WebApp URL
URL=https://$SUBDOMAIN.$DOMAIN

## transactional email is sent from this email address
SUPPORT_EMAIL=support@$DOMAIN

## custom domain needs to point to these MX servers
EMAIL_SERVERS_WITH_PRIORITY=[(10, "$SUBDOMAIN.$EMAIL_DOMAIN.")]

## By default, new aliases must end with ".{random_word}". This is to avoid a person taking all "nice" aliases.
## In self-hosted, you typically trust all users. Set this variable to disable this option.
DISABLE_ALIAS_SUFFIX=1

## the DKIM private key used to compute DKIM-Signature
DKIM_PRIVATE_KEY_PATH=/dkim.key

## DB Connection
DB_URI=postgresql://$POSTGRES_USER:$POSTGRES_PASSWORD@sl-db:5432/$POSTGRES_DB

## Database Wait Timeout (in seconds)
## How long the migration container should wait for the database to be ready
## before giving up. Default: 60 seconds
## Increase this if your database takes longer to initialize
# DB_WAIT_TIMEOUT=60

FLASK_SECRET=paste-flask-secret-here

GNUPGHOME=/sl/pgp

LOCAL_FILE_UPLOAD=1

POSTFIX_SERVER=postfix

# DISABLE_REGISTRATION=1
# DISABLE_ONBOARDING=true

## Traefik
## =======

## E-Mail used for Letsencrypt registration
LE_EMAIL=$SUPPORT_EMAIL

## Set requested ACME CHALLENGE to one of [ "tls", "dns" ]
## see https://letsencrypt.org/docs/challenge-types/
## 1) "tls" (-ALPN) is default and works out of the box - but cannot request wildcard certificates
## 2) "dns" can request wildcard certificates, 
##    but needs additional configuration depending on your DNS registrar
LE_CHALLENGE=tls

## If you use LE_CHALLENGE=dns, you have to define your DNS provider here
## see https://go-acme.github.io/lego/dns/ which "Code" identifies your provider
# LE_DNS_PROVIDER=cloudflare

## Depending on your DNS Provider, you have to set additional ENV vars

## Cloudflare, see: https://go-acme.github.io/lego/dns/cloudflare/index.html#api-tokens
# CF_DNS_API_TOKEN=paste-cloudflare-api-token-here

## Azure DNS, see: https://go-acme.github.io/lego/dns/azuredns/index.html
# AZURE_CLIENT_ID=<your service principal client ID>
# AZURE_TENANT_ID=<your service principal tenant ID>
# AZURE_CLIENT_SECRET=<your service principal client secret>

## IONOS
# IONOS_API_KEY=<your ionos API key>

## MTA-STS Configuration
## =====================
## MTA-STS (SMTP MTA Strict Transport Security) protects email traffic with TLS
## See: https://datatracker.ietf.org/doc/html/rfc8461

## MTA-STS hosting mode: auto, internal, external, or disabled
## - auto: Automatically detect if MTA-STS is hosted externally (recommended)
## - internal: Force internal hosting via Traefik (default if external detection fails)
## - external: Skip internal hosting, assume external hosting (e.g., Cloudflare Pages)
## - disabled: Disable MTA-STS completely (not recommended for production)
MTA_STS_MODE=auto

## MTA-STS policy mode: testing, enforce, or none
## - testing: Receivers report but don't enforce policy failures (recommended for initial setup)
## - enforce: Receivers enforce TLS policy strictly (use after validating with testing mode)
## - none: Disable MTA-STS policy (only use if MTA_STS_MODE=disabled)
MTA_STS_POLICY_MODE=testing

## MTA-STS max_age in seconds (default: 86400 = 24 hours)
## How long receivers should cache the MTA-STS policy
## Recommended: 86400 (1 day) for testing, 604800 (7 days) or more for production
MTA_STS_MAX_AGE=86400
